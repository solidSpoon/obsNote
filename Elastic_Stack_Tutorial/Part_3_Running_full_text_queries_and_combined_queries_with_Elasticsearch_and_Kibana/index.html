
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="../../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.4.0, mkdocs-material-8.5.3" name="generator"/>
<title>Part 3 Running full text queries and combined queries with Elasticsearch and Kibana - obsidian-mkdocs template</title>
<link href="../../assets/stylesheets/main.7a952b86.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.cbb835fc.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body data-md-color-accent="indigo" data-md-color-primary="pink" data-md-color-scheme="default" dir="ltr">
<script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#part-3-running-full-text-queries-and-combined-queries-with-elasticsearch-and-kibana">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="obsidian-mkdocs template" class="md-header__button md-logo" data-md-component="logo" href="../.." title="obsidian-mkdocs template">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            obsidian-mkdocs template
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Part 3 Running full text queries and combined queries with Elasticsearch and Kibana
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="pink" data-md-color-scheme="default" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"></path></svg>
</label>
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="blue" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="pink" data-md-color-scheme="slate" id="__palette_2" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"></path></svg>
</label>
</form>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="obsidian-mkdocs template" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="obsidian-mkdocs template">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"></path></svg>
</a>
    obsidian-mkdocs template
  </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../..">
        Obsidian Notes
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2">
          Elastic Stack
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Elastic Stack" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
          Elastic Stack
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/">
        Index
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_2" id="__nav_2_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_2">
          1 Getting Started
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="1 Getting Started" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_2">
<span class="md-nav__icon md-icon"></span>
          1 Getting Started
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/1_Getting_Started/1.1_Inspecting_The_Cluster/">
        Inspecting the cluster
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/1_Getting_Started/adding-more-nodes-to-the-cluster/">
        Adding more nodes to the cluster (for development)
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/1_Getting_Started/overview-of-node-roles/">
        Overview of node roles
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/1_Getting_Started/sending-queries-with-curl/">
        Sending queries with cURL
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/1_Getting_Started/setting-up-elasticsearch-kibana-macos-linux/">
        Setting up Elasticsearch &amp; Kibana on macOS &amp; Linux
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/1_Getting_Started/setting-up-elasticsearch-kibana-windows/">
        Setting up Elasticsearch &amp; Kibana on Windows
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/1_Getting_Started/sharding-and-scalability/">
        Sharding and scalability
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/1_Getting_Started/understanding-replication/">
        Understanding replication
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_3" id="__nav_2_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_3">
          3 Managing Documents
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="3 Managing Documents" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_3">
<span class="md-nav__icon md-icon"></span>
          3 Managing Documents
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/3_Managing_Documents/batch-processing/">
        Batch processing
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/3_Managing_Documents/creating-and-deleting-indices/">
        Creating &amp; Deleting Indices
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/3_Managing_Documents/delete-by-query/">
        Delete by query
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/3_Managing_Documents/deleting-documents/">
        Deleting documents
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/3_Managing_Documents/importing-data-with-curl/">
        Importing data with cURL
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/3_Managing_Documents/indexing-documents/">
        Indexing documents
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/3_Managing_Documents/optimistic-concurrency-control/">
        Optimistic concurrency control
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/3_Managing_Documents/replacing-documents/">
        Replacing documents
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/3_Managing_Documents/retrieving-documents-by-id/">
        Retrieving documents by ID
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/3_Managing_Documents/scripted-updates/">
        Scripted updates
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/3_Managing_Documents/update-by-query/">
        Update by query
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/3_Managing_Documents/updating-documents/">
        Updating documents
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/3_Managing_Documents/upserts/">
        Upserts
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_4" id="__nav_2_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_4">
          Adding Boolean Logic to Queries
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Adding Boolean Logic to Queries" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_4">
<span class="md-nav__icon md-icon"></span>
          Adding Boolean Logic to Queries
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Adding%20Boolean%20Logic%20to%20Queries/debugging-bool-queries-with-named-queries/">
        Debugging `bool` queries with named queries
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Adding%20Boolean%20Logic%20to%20Queries/how-the-match-query-works/">
        How the `match` query works
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Adding%20Boolean%20Logic%20to%20Queries/querying-with-boolean-logic/">
        Querying with boolean logic
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_5" id="__nav_2_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_5">
          Aggregations
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Aggregations" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_5">
<span class="md-nav__icon md-icon"></span>
          Aggregations
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Aggregations/aggregating-nested-objects/">
        Aggregating nested objects
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Aggregations/defining-bucket-rules-with-filters/">
        Defining bucket rules with filters
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Aggregations/filtering-out-documents/">
        Filtering out documents
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Aggregations/global-aggregation/">
        `global` aggregation
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Aggregations/histograms/">
        Histograms
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Aggregations/introduction-to-aggregations/">
        Introduction to aggregations
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Aggregations/introduction-to-bucket-aggregations/">
        Introduction to bucket aggregations
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Aggregations/metric-aggregations/">
        Metric aggregations
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Aggregations/missing-field-values/">
        Missing field values
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Aggregations/nested-aggregations/">
        Nested aggregations
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Aggregations/range-aggregations/">
        Range aggregations
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_6" id="__nav_2_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_6">
          Controlling Query Results
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Controlling Query Results" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_6">
<span class="md-nav__icon md-icon"></span>
          Controlling Query Results
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Controlling%20Query%20Results/filters/">
        Filters
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Controlling%20Query%20Results/sorting-by-multi-value-fields/">
        Sorting by multi-value fields
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Controlling%20Query%20Results/sorting-results/">
        Sorting results
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Controlling%20Query%20Results/source-filtering/">
        Source filtering
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Controlling%20Query%20Results/specifying-an-offset/">
        Specifying an offset
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Controlling%20Query%20Results/specifying-the-result-format/">
        Specifying the result format
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Controlling%20Query%20Results/specifying-the-result-size/">
        Specifying the result size
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_7" id="__nav_2_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_7">
          Full Text Queries
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Full Text Queries" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_7">
<span class="md-nav__icon md-icon"></span>
          Full Text Queries
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Full%20Text%20Queries/exercises/">
        Exercises
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Full%20Text%20Queries/flexible-matching-with-match-query/">
        Flexible matching with `match` query
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Full%20Text%20Queries/introduction-to-full-text-queries/">
        Introduction to full text queries
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Full%20Text%20Queries/matching-phrases/">
        Matching phrases
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Full%20Text%20Queries/searching-multiple-fields/">
        Searching multiple fields
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_8" id="__nav_2_8" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_8">
          Improving Search Results
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Improving Search Results" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_8">
<span class="md-nav__icon md-icon"></span>
          Improving Search Results
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Improving%20Search%20Results/adding-synonyms-from-file/">
        Adding synonyms from file
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Improving%20Search%20Results/adding-synonyms/">
        Adding synonyms
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Improving%20Search%20Results/affecting-relevance-scoring-with-proximity/">
        Affecting relevance scoring with proximity
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Improving%20Search%20Results/fuzzy-match-query/">
        Fuzzy `match` query
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Improving%20Search%20Results/fuzzy-query/">
        `fuzzy` query
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Improving%20Search%20Results/highlighting-matches-in-fields/">
        Highlighting matches in fields
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Improving%20Search%20Results/proximity-searches/">
        Proximity searches
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Improving%20Search%20Results/stemming/">
        Stemming
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_9" id="__nav_2_9" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_9">
          Introduction to Searching
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Introduction to Searching" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_9">
<span class="md-nav__icon md-icon"></span>
          Introduction to Searching
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Introduction%20to%20Searching/debugging-unexpected-query-results/">
        Debugging unexpected query results
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Introduction%20to%20Searching/full-text-queries-vs-term-level-queries/">
        Full text queries vs term level queries
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Introduction%20to%20Searching/introducing-the-query-dsl/">
        Introducing the Query DSL
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Introduction%20to%20Searching/searching-with-the-request-uri/">
        Searching with the request URI
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Introduction%20to%20Searching/understanding-relevance-scores/">
        Understanding relevance scores
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_10" id="__nav_2_10" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_10">
          Joining Queries
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Joining Queries" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_10">
<span class="md-nav__icon md-icon"></span>
          Joining Queries
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Joining%20Queries/adding-documents/">
        Adding documents
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Joining%20Queries/mapping-document-relationships/">
        Mapping document relationships
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Joining%20Queries/multi-level-relations/">
        Multi-level relations
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Joining%20Queries/nested-inner-hits/">
        Nested inner hits
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Joining%20Queries/parent-child-inner-hits/">
        Parent/child inner hits
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Joining%20Queries/querying-by-parent-id/">
        Querying by parent
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Joining%20Queries/querying-child-documents-by-parent/">
        Querying child documents by parent
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Joining%20Queries/querying-nested-objects/">
        Querying nested objects
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Joining%20Queries/querying-parent-by-child-documents/">
        Querying parent by child documents
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Joining%20Queries/terms-lookup-mechanism/">
        Terms lookup mechanism
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_11" id="__nav_2_11" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_11">
          Mapping &amp; Analysis
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Mapping &amp; Analysis" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_11">
<span class="md-nav__icon md-icon"></span>
          Mapping &amp; Analysis
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Mapping%20%26%20Analysis/adding-analyzers-to-existing-indices/">
        Adding analyzers to existing indices
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Mapping%20%26%20Analysis/adding-explicit-mappings/">
        Adding explicit mappings
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Mapping%20%26%20Analysis/adding-mappings-to-existing-indices/">
        Adding mappings to existing indices
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Mapping%20%26%20Analysis/combining-explicit-and-dynamic-mapping/">
        Combining explicit and dynamic mapping
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Mapping%20%26%20Analysis/configuring-dynamic-mapping/">
        Configuring dynamic mapping
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Mapping%20%26%20Analysis/creating-custom-analyzers/">
        Creating custom analyzers
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Mapping%20%26%20Analysis/defining-field-aliases/">
        Defining field aliases
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Mapping%20%26%20Analysis/dynamic-templates/">
        Dynamic templates
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Mapping%20%26%20Analysis/how-dates-work-in-elasticsearch/">
        How dates work in Elasticsearch
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Mapping%20%26%20Analysis/how-the-keyword-data-type-works/">
        How the `keyword` data type works
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Mapping%20%26%20Analysis/index-templates/">
        Index templates
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Mapping%20%26%20Analysis/multi-field-mappings/">
        Multi-field mappings
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Mapping%20%26%20Analysis/reindexing-documents-with-the-reindex-api/">
        Reindexing documents with the Reindex API
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Mapping%20%26%20Analysis/retrieving-mappings/">
        Retrieving mappings
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Mapping%20%26%20Analysis/understanding-arrays/">
        Understanding arrays
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Mapping%20%26%20Analysis/understanding-type-coercion/">
        Understanding type coercion
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Mapping%20%26%20Analysis/updating-analyzers/">
        Updating analyzers
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Mapping%20%26%20Analysis/updating-existing-mappings/">
        Updating existing mappings
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Mapping%20%26%20Analysis/using-dot-notation-in-field-names/">
        Using dot notation in field names
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Mapping%20%26%20Analysis/using-the-analyze-api/">
        Using the Analyze API
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_12" id="__nav_2_12" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_12">
          Term Level Queries
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Term Level Queries" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_12">
<span class="md-nav__icon md-icon"></span>
          Term Level Queries
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Term%20Level%20Queries/exercises/">
        Exercises
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Term%20Level%20Queries/matching-based-on-prefixes/">
        Matching based on prefixes
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Term%20Level%20Queries/matching-documents-with-non-null-values/">
        Matching documents with non-null values
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Term%20Level%20Queries/matching-documents-with-range-values/">
        Matching documents with range values
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Term%20Level%20Queries/retrieving-documents-based-on-ids/">
        Retrieving documents based on IDs
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Term%20Level%20Queries/searching-for-a-term/">
        Searching for a term
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Term%20Level%20Queries/searching-for-multiple-terms/">
        Searching for multiple terms
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Term%20Level%20Queries/searching-with-regular-expressions/">
        Searching with regular expressions
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Term%20Level%20Queries/searching-with-wildcards/">
        Searching with wildcards
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../Elastic_Stack/Term%20Level%20Queries/working-with-relative-dates/">
        Working with relative dates
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3">
          Elastic Stack Tutorial
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Elastic Stack Tutorial" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
          Elastic Stack Tutorial
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../Part_1_Intro_to_Elasticsearch_%26_Kibana/">
        Part 1: Intro to Elasticsearch &amp; Kibana
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Part_2_Understanding_the_relevance_of_your_search_with_Elasticsearch_and_Kibana/">
        Part 2 Understanding the relevance of your search with Elasticsearch and Kibana
      </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
          Part 3 Running full text queries and combined queries with Elasticsearch and Kibana
          <span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
        Part 3 Running full text queries and combined queries with Elasticsearch and Kibana
      </a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#part-3-running-full-text-queries-and-combined-queries-with-elasticsearch-and-kibana">
    Part 3: Running full text queries and combined queries with Elasticsearch and Kibana
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#review-from-workshop-part-2">
    Review from Workshop Part 2
  </a>
<nav aria-label="Review from Workshop Part 2" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#search-queries">
    Search queries
  </a>
<nav aria-label="Search queries" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#get-information-about-documents-in-an-index">
    Get information about documents in an index
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#aggregations-request">
    Aggregations Request
  </a>
<nav aria-label="Aggregations Request" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#analyze-the-data-to-show-the-categories-of-news-headlines-in-our-dataset">
    Analyze the data to show the categories of news headlines in our dataset
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#full-text-queries">
    Full Text Queries
  </a>
<nav aria-label="Full Text Queries" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#searching-for-search-terms">
    Searching for search terms
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#searching-for-a-phrase">
    Searching for a phrase
  </a>
<nav aria-label="Searching for a phrase" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#what-happens-when-you-use-the-match-query-to-search-for-phrases">
    What happens when you use the match query to search for phrases?
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#searching-for-phrases-using-the-match_phrase-query">
    Searching for phrases using the match_phrase query
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#running-a-match-query-against-multiple-fields">
    Running a match query against multiple fields
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Part_4_Running_Aggregations_with_Elasticsearch_and_Kibana/">
        Beginner's Crash Course to Elastic Stack Series
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Part_5_Understanding_Mapping_with_Elasticsearch_and_Kibana/">
        Part 5 Understanding Mapping with Elasticsearch and Kibana
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../Untitled/">
        Untitled
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#part-3-running-full-text-queries-and-combined-queries-with-elasticsearch-and-kibana">
    Part 3: Running full text queries and combined queries with Elasticsearch and Kibana
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#review-from-workshop-part-2">
    Review from Workshop Part 2
  </a>
<nav aria-label="Review from Workshop Part 2" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#search-queries">
    Search queries
  </a>
<nav aria-label="Search queries" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#get-information-about-documents-in-an-index">
    Get information about documents in an index
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#aggregations-request">
    Aggregations Request
  </a>
<nav aria-label="Aggregations Request" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#analyze-the-data-to-show-the-categories-of-news-headlines-in-our-dataset">
    Analyze the data to show the categories of news headlines in our dataset
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#full-text-queries">
    Full Text Queries
  </a>
<nav aria-label="Full Text Queries" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#searching-for-search-terms">
    Searching for search terms
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#searching-for-a-phrase">
    Searching for a phrase
  </a>
<nav aria-label="Searching for a phrase" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#what-happens-when-you-use-the-match-query-to-search-for-phrases">
    What happens when you use the match query to search for phrases?
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#searching-for-phrases-using-the-match_phrase-query">
    Searching for phrases using the match_phrase query
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#running-a-match-query-against-multiple-fields">
    Running a match query against multiple fields
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1>Part 3 Running full text queries and combined queries with Elasticsearch and Kibana</h1>
<h2 id="part-3-running-full-text-queries-and-combined-queries-with-elasticsearch-and-kibana">Part 3: Running full text queries and combined queries with Elasticsearch and Kibana<a class="headerlink" href="#part-3-running-full-text-queries-and-combined-queries-with-elasticsearch-and-kibana" title="Permanent link">¶</a></h2>
<p>Workshop objectives:
- delve deeper into advanced queries designed to search text fields
- build a combination of queries to answer more complex questions 
- fine-tune the relevance of search results</p>
<h2 id="review-from-workshop-part-2">Review from Workshop Part 2<a class="headerlink" href="#review-from-workshop-part-2" title="Permanent link">¶</a></h2>
<p>There are two main ways to search in Elasticsearch:
1) <code>Queries</code> retrieve documents that match the specified criteria. 
2) <code>Aggregations</code> present the summary of your data as metrics, statistics, and other analytics.  </p>
<h3 id="search-queries">Search queries<a class="headerlink" href="#search-queries" title="Permanent link">¶</a></h3>
<h4 id="get-information-about-documents-in-an-index">Get information about documents in an index<a class="headerlink" href="#get-information-about-documents-in-an-index" title="Permanent link">¶</a></h4>
<p>The following <code>query</code> will retrieve all documents that exist in the specified index. This <code>query</code> is a great way to explore the structure and content of your document. </p>
<p>Syntax: </p>
<pre><code>GET Enter_name_of_the_index_here/_search
</code></pre>
<p>Example: </p>
<pre><code>GET news_headlines/_search
</code></pre>
<p>Expected response from Elasticsearch:</p>
<p>Elasticsearch displays a number of hits and a sample of 10 search results by default. The field "_ source"(line 22) lists all fields(the content) of a document.</p>
<p><img alt="image" src="https://user-images.githubusercontent.com/60980933/105432767-8c216700-5c15-11eb-9ea2-ef74a3bc5f1b.png"/></p>
<h3 id="aggregations-request">Aggregations Request<a class="headerlink" href="#aggregations-request" title="Permanent link">¶</a></h3>
<h4 id="analyze-the-data-to-show-the-categories-of-news-headlines-in-our-dataset">Analyze the data to show the categories of news headlines in our dataset<a class="headerlink" href="#analyze-the-data-to-show-the-categories-of-news-headlines-in-our-dataset" title="Permanent link">¶</a></h4>
<p>Syntax:</p>
<pre><code>GET Enter_name_of_the_index_here/_search
{
  "aggregations": {
    "Name your aggregation here": {
      "Specify aggregation type here": {
        "field": "Name the field you want to aggregate here",
        "size": State how many buckets you want returned here
      }
    }
  }
}
</code></pre>
<p>Example:</p>
<pre><code>GET news_headlines/_search
{
  "aggregations": {
    "by_category": {
      "terms": {
        "field": "category",
        "size": 100
      }
    }
  }
}
</code></pre>
<p>Expected response from Elasticsearch:</p>
<p>When you minimize hits(line 10), you will see the aggregations report we named by_category. This report displays all categories that exist in our datset as well as the number of documents that fall under each category. </p>
<p><img alt="image" src="https://user-images.githubusercontent.com/60980933/105434428-cc361900-5c18-11eb-9db7-e7441ac5a1ac.png"/></p>
<h2 id="full-text-queries">Full Text Queries<a class="headerlink" href="#full-text-queries" title="Permanent link">¶</a></h2>
<h3 id="searching-for-search-terms">Searching for search terms<a class="headerlink" href="#searching-for-search-terms" title="Permanent link">¶</a></h3>
<p>The <code>match query</code> is a standard query for performing a full text search. This <code>query</code> retrieves documents that contain the search terms. It uses "OR" logic by default, meaning that it will retrieve documents that contain any one of the search terms. The order and the proximity in which the search terms are found(i.e. phrases) are not taken into account.</p>
<p>Syntax:</p>
<pre><code>GET Enter_name_of_index_here/_search
{
  "query": {
    "match": {
      "Specify the field you want to search": {
        "query": "Enter search terms"
      }
    }
  }
}
</code></pre>
<p><img alt="image" src="https://user-images.githubusercontent.com/60980933/135136014-0c608cfe-9991-459b-a749-505f7c699fcf.png"/></p>
<h3 id="searching-for-a-phrase">Searching for a phrase<a class="headerlink" href="#searching-for-a-phrase" title="Permanent link">¶</a></h3>
<h4 id="what-happens-when-you-use-the-match-query-to-search-for-phrases">What happens when you use the <code>match query</code> to search for phrases?<a class="headerlink" href="#what-happens-when-you-use-the-match-query-to-search-for-phrases" title="Permanent link">¶</a></h4>
<p>Let's search for articles about Ed Sheeran's song "Shape of you" using the <code>match query</code>.</p>
<p>Example: </p>
<pre><code class="language-http">GET news_headlines/_search
{
  "query": {
    "match": {
      "headline": {
        "query": "Shape of you"
      }
    }
  }
}
</code></pre>
<p>Expected response from Elasticsearch:</p>
<p>Elasticsearch returns greater than 10,000 hits. The top hit as well as many others in the search results only contain the search terms "you" and "shape". These terms are not found in the same order or in proximity to each other as the search terms "Shape of you". </p>
<p>When the <code>match query</code> is used to search for a phrase, it has high recall but low precision as it returns a lot of loosely related documents.</p>
<p><img alt="image" src="https://user-images.githubusercontent.com/60980933/108571746-17058800-72ce-11eb-8b44-57df1cbb35d1.png"/></p>
<p>Along with a few articles about the song "Shape of you", it pulls up articles about being in shape or what shape of your face says about you. </p>
<p>When the <code>match query</code> is used to search for a phrase, it has high recall but low precision. It pulls up more loosely related documents as it uses "OR" logic by default. It pulls up documents that contains any one of the search terms in the specified field. Moreover, the order and the proximity in which the search terms are found are not taken into account.</p>
<h4 id="searching-for-phrases-using-the-match_phrase-query">Searching for phrases using the <code>match_phrase</code> query<a class="headerlink" href="#searching-for-phrases-using-the-match_phrase-query" title="Permanent link">¶</a></h4>
<p>If the order and the proximity in which the search terms are found(i.e. phrases) are important in determining the relevance of your search, you use the <code>match_phrase query</code>.</p>
<p>Syntax: </p>
<pre><code>GET Enter_name_of_index_here/_search
{
  "query": {
    "match_phrase": {
      "Specify the field you want to search": {
        "query": "Enter search terms"
      }
    }
  }
}
</code></pre>
<p>Example: </p>
<pre><code>GET news_headlines/_search
{
  "query": {
    "match_phrase": {
      "headline": {
        "query": "Shape of You"
      }
    }
  }
}
</code></pre>
<p>When the <code>match_phrase</code> parameter is used, all hits must meet the following criteria:
1. the search terms "Shape", "of", and "you" must appear in the field headline .
2. the terms must appear in that order.
3. the terms must appear next to each other.</p>
<p>Expected response from Elasticsearch:</p>
<p>With <code>match_phrase</code> parameter, we get 3 hits returned. All 3 hits satisfy the criteria mentioned above. </p>
<p>The <code>match_phrase</code> parameter yields higher precision but lower recall as it takes the order and the proximity in which the search terms are found into account. </p>
<p><img alt="image" src="https://user-images.githubusercontent.com/60980933/108422566-f537d280-71f3-11eb-8340-2899b5fbc61e.png"/></p>
<h3 id="running-a-match-query-against-multiple-fields">Running a match query against multiple fields<a class="headerlink" href="#running-a-match-query-against-multiple-fields" title="Permanent link">¶</a></h3>
<p>When designing a <code>query</code>, you don't always know the context of a user's search. When a user searches for "Michelle Obama", the user could be searching for statements written by Michelle Obama or articles written about her.</p>
<p>To accommodate these contexts, you can write a <code>multi_match query</code>, which searches for terms in multiple fields.</p>
<p>The <code>multi_match query</code> runs a <code>match query</code> on multiple fields and calculates a score for each field. Then, it assigns the highest score among the fields to the document.</p>
<p>This score will determine the ranking of the document within the search results.</p>
<p>Syntax:</p>
<pre><code>GET Enter_the_name_of_the_index_here/_search
{
  "query": {
    "multi_match": {
      "query": "Enter search terms here",
      "fields": [
        "List the field you want to search over",
        "List the field you want to search over",
        "List the field you want to search over"
      ]
    }
  }
}
````
The following `multi_match query` asks Elasticsearch to `query` documents that contain the search terms "Michelle" or "Obama" in the fields headline, or short_description, or authors.

Example:
</code></pre>
<p>GET news_headlines/_search
{
  "query": {
    "multi_match": {
      "query": "Michelle Obama",
      "fields": [
        "headline",
        "short_description",
        "authors"
      ]
    }
  }
}</p>
<pre><code>Expected response from Elasticsearch:

We see 3044 hits that contain "Michelle Obama" in the headline or short_description or author field. While the `multi_match query` increased the recall, it decreased the precision of the hits. 

For example, in our search for "Michelle Obama" related headlines, the top hit is a news headline featuring Bernie Sanders as the main topic. In this headline, Michelle Obama is mentioned once in the field short_description.

![image](https://user-images.githubusercontent.com/60980933/127704425-c1ade381-dff4-446f-9980-1caa9a85e972.png)

#### Per-field boosting
Headlines mentioning "Michelle Obama" in the field headline are more likely to be related to our search than the headlines that mention "Michelle Obama" once or twice in the field short_description.

To improve the precision of your search, you can designate one field to carry more weight than the others.

This can be done by boosting the score of the field headline(`per-field boosting`). This is notated by adding a carat(^) symbol and number 2 to the desired field as shown below.

Syntax:
</code></pre>
<p>GET Enter_the_name_of_the_index_here/_search
{
  "query": {
    "multi_match": {
      "query": "Enter search terms",
      "fields": [
        "List field you want to boost^2",
        "List field you want to search over",
        "List field you want to search over"
      ]
    }
  }
}</p>
<pre><code>The following example boosts the score of documents that contain the search terms in the field headline. If the term "Michelle" or "Obama" are found in the field headline of a document, that document is given a higher score and is ranked higher in the search results.

Example:
</code></pre>
<p>GET news_headlines/_search
{
  "query": {
    "multi_match": {
      "query": "Michelle Obama",
      "fields": [
        "headline^2",
        "short_description",
        "authors"
      ]
    }
  }
}</p>
<pre><code>Expected response from Elasticsearch:

`Per-field boosting` yields same number of hits(5128). However, it changes the ranking of the hits. The hits ranked higher on the list contains the search terms "Michelle Obama" in the boosted field, headline.

![image](https://user-images.githubusercontent.com/60980933/108877609-a5268a80-75bc-11eb-8f61-ce1d1702a6e0.png)

The documents containing the search terms "Michelle Obama" in the field headline are more likely to be about Michelle Obama. By using the `per-field boosting`, we have improved the precision of our search!

#### What happens when you use the `multi_match` query to search for a phrase?

While searching for Michelle Obama, the user remembers that she is throwing a party for all of her friends this weekend. She searches for news headlines regarding "party planning" to get some ideas for it.

She uses the `multi_match query` to search for the phrase party planning.

Example:
</code></pre>
<p>GET news_headlines/_search
{
  "query": {
    "multi_match": {
      "query": "party planning",
      "fields": [
        "headline^2",
        "short_description"
      ]
    }
  }
}</p>
<pre><code>Response from Elasticsearch:

This query yields a lot of hits(2846). 

![image](https://user-images.githubusercontent.com/60980933/108582689-09fa9000-72f2-11eb-8e34-8f6cc4302254.png)

But why does one of our top 10 hits feature Bernie Sanders **planning** a national tour for grassroots **party** activism?

The terms "party" and "planning" are popular terms found in many documents.

With the `multi_match query`, a document is considered as a hit if any one of these search terms were found in any one of the specified fields. It does not take into account the order or the proximity in which these search terms are found.

Because of that, you will see loosely related search results included among the top hits.

#### Improving precision with phrase type match

You can improve the precision of a `multi_match query` by adding the "type":"phrase" to the query.

The phrase type performs a `match_phrase query` on each field and calculates a score for each field. Then, it assigns the highest score among the fields to the document.

Syntax:
</code></pre>
<p>GET Enter_the_name_of_the_index_here/_search
{
  "query": {
    "multi_match": {
      "query": "Enter search phrase",
      "fields": [
        "List field you want to boost^2",
        "List field you want to search over",
        "List field you want to search over"
      ],
      "type": "phrase"
    }
  }
}</p>
<pre><code>The following query asks Elasticsearch to look up the phrase "party planning" in the fields headline and short_description.

Using `per field boosting`, this query assigns a higher score to documents containing the phrase "party planning" in the field headline. The documents that include the phrase "party planning" in the field headline will be ranked higher in the search results.

Example:
</code></pre>
<p>GET news_headlines/_search
{
  "query": {
    "multi_match": {
      "query": "party planning",
      "fields": [
        "headline^2",
        "short_description"
      ],
      "type": "phrase"
    }
  }
}</p>
<pre><code>Expected response from Elasticsearch:

The recall is much lower(6 vs 2846 hits) but every one of the hits have the phrase "party planning" in either the field headline or short_description or both.

![image](https://user-images.githubusercontent.com/60980933/108615437-4943e200-73c1-11eb-87ac-881b6a20d962.png)

Among these, the hits that have the phrase "party planning" in the boosted field headline are ranked higher in the search results and presented towards the top of the search results.

## Combined Queries

There will be times when a user asks a multi-faceted question that requires multiple `queries` to answer.

For example, a user may want to find political headlines about Michelle Obama published before the year 2016.

This search is actually a combination of three `queries`:

1) Query headlines that contain the search terms "Michelle Obama" in the field headline.
2) Query "Michelle Obama" headlines from the "POLITICS" category.
3) Query "Michelle Obama" headlines published before the year 2016

One of the ways you can combine these queries is through a `bool query`.

### Bool Query
The [bool query](https://www.elastic.co/guide/en/elasticsearch/reference/6.8/query-dsl-bool-query.html#:~:text=Bool%20Queryedit,clause%20with%20a%20typed%20occurrence.) retrieves documents matching boolean combinations of other `queries`. 

With the `bool query`, you can combine multiple `queries` into one request and further specify boolean clauses to narrow down your search results.

There are four clauses to choose from: 

1. must
2. must_not
3. should 
4. filter

You can build combinations of one or more of these clauses.
Each clause can contain one or multiple queries that specify the criteria of each clause. 

These clauses are optional and can be mixed and matched to cater to your use case. The order in which they appear does not matter either! 

Syntax:
</code></pre>
<p>GET name_of_index/_search
{
  "query": {
    "bool": {
      "must": [
        {One or more queries can be specified here. A document MUST match all of these queries to be considered as a hit.}
      ],
      "must_not": [
        {A document must NOT match any of the queries specified here. It it does, it is excluded from the search results.}
      ],
      "should": [
        {A document does not have to match any queries specified here. However, it if it does match, this document is given a higher score.}
      ],
      "filter": [
        {These filters(queries) place documents in either yes or no category. Ones that fall into the yes category are included in the hits. }
      ]
    }
  }
}</p>
<pre><code>#### A combination of query and aggregation request

A `bool query` can help you answer multi-faceted questions. Before we go over the four clauses of the bool query, we need to first understand what type of questions we can ask about Michelle Obama.

Let's first figure out what headlines have been written about her.

One way to understand that is by searching for categories of headlines that mention Michelle Obama.

Syntax:
</code></pre>
<p>GET Enter_name_of_the_index_here/_search
{
  "query": {
    "Enter match or match_phrase here": { "Enter the name of the field": "Enter the value you are looking for" }
  },
  "aggregations": {
    "Name your aggregation here": {
      "Specify aggregation type here": {
        "field": "Name the field you want to aggregate here",
        "size": State how many buckets you want returned here
      }
    }
  }
}</p>
<pre><code>The following query ask Elasticsearch to query all data that has the phrase "Michelle Obama" in the headline. Then, perform aggregations on the queried data and retrieve up to 100 categories that exist in the queried data.

Example:
</code></pre>
<p>GET news_headlines/_search
{
  "query": {
    "match_phrase": {
      "headline": "Michelle Obama"
    }
  },
  "aggregations": {
    "category_mentions": {
      "terms": {
        "field": "category",
        "size": 100
      }
    }
  }
}</p>
<pre><code>Expected reponse from Elasticsearch:

When you minimize the hits field(line 10), you will see an aggregations report called category_mentions. This report displays an array of all the categories that exist in the queried data and the number of headlines that have been written about each category.

We see that many news headlines about Michelle Obama has been written under categories such as "POLITICS", "BLACK VOICES", "PARENTING", "TASTE", and even "WEDDINGS"!

![image](https://user-images.githubusercontent.com/60980933/108541130-5668b000-729f-11eb-80aa-8e37b6dc016c.png)

**Now let's get back to the bool query!**

With the `bool query`, you can combine multiple `queries` into one request and further specify boolean clauses to narrow down your search results.

There are four clauses to choose from:

- must
- must_not
- should
- filter

#### The must clause
The `must clause` defines all `queries`(criteria) a document MUST match to be returned as hits. These criteria are expressed in the form of one or multiple `queries`.

All `queries` in the `must clause` must be satisfied for a document to be returned as a hit. As a result, having more `queries` in the `must clause` will increase the precision of your `query`. 

Syntax:
</code></pre>
<p>GET Enter_name_of_the_index_here/_search
{
  "query": {
    "bool": {
      "must": [
        {
        "Enter match or match_phrase here": {
          "Enter the name of the field": "Enter the value you are looking for" 
         }
        },
        {
          "Enter match or match_phrase here": {
            "Enter the name of the field": "Enter the value you are looking for" 
          }
        }
      ]
    }
  }
}</p>
<pre><code>The following is a `bool query` that uses the `must clause`. This `query` specifies that all hits must match the phrase "Michelle Obama" in the field headline and match the term "POLITICS" in the field category.

Example:
</code></pre>
<p>GET news_headlines/_search
{
  "query": {
    "bool": {
      "must": [
        {
        "match_phrase": {
          "headline": "Michelle Obama"
         }
        },
        {
          "match": {
            "category": "POLITICS"
          }
        }
      ]
    }
  }
}</p>
<pre><code>Expected response from Elasticsearch: 

You get 45 hits. All documents contain the phrase "Michelle Obama" in the field headline and the term "POLITICS" in the field category.

![image](https://user-images.githubusercontent.com/60980933/108631596-cbff8800-7427-11eb-9ac0-2f172075f9ed.png)

#### The must_not clause
The `must_not` clause defines `queries`(criteria) a document MUST NOT match to be included in the search results. 

Syntax:
</code></pre>
<p>GET Enter_name_of_the_index_here/_search
{
  "query": {
    "bool": {
      "must": [
        {
        "Enter match or match_phrase here": {
          "Enter the name of the field": "Enter the value you are looking for" 
         }
        },
       "must_not":[
         {
          "Enter match or match_phrase here": {
            "Enter the name of the field": "Enter the value you are looking for"
          }
        }
      ]
    }
  }
}</p>
<pre><code>What if you want all Michelle Obama headlines except for the ones that belong in the "WEDDINGS" category?

The following `bool query` specifies that all hits must contain the phrase "Michelle Obama" in the field headline. However, the hits `must_not` contain the term "WEDDINGS" in the field category.

Example:

</code></pre>
<p>GET news_headlines/_search
{
  "query": {
    "bool": {
      "must": {
        "match_phrase": {
          "headline": "Michelle Obama"
         }
        },
       "must_not":[
         {
          "match": {
            "category": "WEDDINGS"
          }
        }
      ]
    }
  }
}</p>
<pre><code>Expected response from Elasticsearch:

This `query` increases the recall(203 hits). It pulls up all the hits that contain the phrase "Michelle Obama" in the field headline. Among the hits, Elasticsearch excludes all documents that contain the term "WEDDINGS" in the field category.

![image](https://user-images.githubusercontent.com/60980933/108631753-99a25a80-7428-11eb-819a-c284e0ebb1b1.png)

#### The should clause
The `should clause` adds "nice to have" `queries`(criteria). The documents do not need to match the "nice to have" `queries` to be considered as hits. However, the ones that do will be given a higher score so it shows up higher in the search results. 

Syntax:
</code></pre>
<p>GET Enter_name_of_the_index_here/_search
{
  "query": {
    "bool": {
      "must": [
        {
        "Enter match or match_phrase here: {
          "Enter the name of the field": "Enter the value you are looking for" 
         }
        },
       "should":[
         {
          "Enter match or match_phrase here": {
            "Enter the name of the field": "Enter the value you are looking for"
          }
        }
      ]
    }
  }</p>
<pre><code>
Let's talk about a scenario where we may use the `should clause`. During the Black History Month, it is possible that the user may be looking up "Michelle Obama" in the context of "BLACK VOICES" category rather than in the context of "WEDDINGS", "TASTE", or "STYLE" categories.

To accommodate this scenario, you may write a `query` where all hits MUST contain "Michelle Obama" in the field headline. Having the phrase "BLACK VOICES" in the category is not required. However, if a document contains the phrase "BLACK VOICES" in the field category, this document should be given a higher score and should be placed higher in the search results.

To accommodate this scenario, you would write the following `bool query`. It specifies that all hits must match the phrase "Michelle Obama" in the field headline. `Should` a hit match the phrase "BLACK VOICES" in the field category, this hit will be given a higher score and will be shown higher in the search results.

Example:
</code></pre>
<p>GET news_headlines/_search
{
  "query": {
    "bool": {
      "must": [
        {
        "match_phrase": {
          "headline": "Michelle Obama"
          }
         }
        ],
       "should":[
         {
          "match_phrase": {
            "category": "BLACK VOICES"
          }
        }
      ]
    }
  }
}</p>
<pre><code>Expected response: 

We should still get the same number of hits(207) as the `should clause` does not add or exclude more hits. However, you will notice that the ranking of the documents has been changed. The documents with the phrase "BLACK VOICES" in the field category are now presented at the top of the search results.

![image](https://user-images.githubusercontent.com/60980933/108632370-be4c0180-742b-11eb-8c03-75c7809b54b8.png)

#### The filter clause
The `filter clause` contains filter `queries` that place documents into either "yes" or "no" category.

For example, let's say you are looking for headlines published within a certain time range. Some documents will fall within this range(yes) or do not fall within this range(no).

The `filter clause` only includes documents that fall into the yes category.

Syntax:
</code></pre>
<p>GET Enter_name_of_the_index_here/_search
{
  "query": {
    "bool": {
      "must": [
        {
        "Enter match or match_phrase here": {
          "Enter the name of the field": "Enter the value you are looking for" 
         }
        }
        ],
       "filter":{
          "range":{
             "date": {
               "gte": "Enter lowest value of the range here",
               "lte": "Enter highest value of the range here"
          }
        }
      }
    }
  }
}</p>
<pre><code>Let's say we wanted to retrieve hits that must include the phrase "Michelle Obama" in the field headline. Among these hits, you want to include documents published within the date range "2014-03-25" and "2016-03-25".

You `bool query` will look something like this.

Example:
</code></pre>
<p>GET news_headlines/_search
{
  "query": {
    "bool": {
      "must": [
        {
        "match_phrase": {
          "headline": "Michelle Obama"
          }
         }
        ],
       "filter":{
          "range":{
             "date": {
               "gte": "2014-03-25",
               "lte": "2016-03-25"
          }
        }
      }
    }
  }
}</p>
<pre><code>Expected response from Elasticsearch: 

You will see 33 hits returned. All hits contain the phrase "Michelle Obama" in the field headline. All hits were published between the date range we specified under the `filter clause`.  

![image](https://user-images.githubusercontent.com/60980933/108633174-15ec6c00-7430-11eb-9153-05d849673f3a.png)

All right. Now that we have mastered the `bool query`, let's figure out how we can fine-tune the relevance of `bool queries`!

#### Fine-tuning the relevance of bool queries

There are many ways you can fine-tune the relevance of `bool queries`.  One of the ways is to add multiple queries under the `should clause`. 

**Adding multiple queries under the should clause**

This approach ensures that you maintain a high recall but also offers a way to present more precise search results at the top of your search results.

Syntax:
</code></pre>
<p>GET Enter_name_of_the_index_here/_search
{
  "query": {
    "bool": {
      "must": [
        {
          "Enter match or match_phrase here": {
            "Enter the name of the field": "Enter the value you are looking for"
          }
        }
      ],
      "should": [
        {
          "Enter match or match_phrase here": {
            "Enter the name of the field": "Enter the value you are looking for"
          }
        },
        {
          "Enter match or match_phrase here": {
            "Enter the name of the field": "Enter the value you are looking for"
          }
        },
        {
          "Enter match or match_phrase here": {
            "Enter the name of the field": "Enter the value you are looking for"
          }
        }
      ]
    }
  }
}</p>
<pre><code>Let's say you want to run a search for news headlines with the phrase "Michelle Obama" in the field headline. But you want to favor articles that mention her biography "Becoming", and terms like "women" and "empower".

To do this, you can add multiple `queries` to the `should clause`.

This will cast a wider net because none of the `queries` in the should clause need to match. However, the ones that match the `queries` under the `should clause` will be given a higher score and placed higher in the search results.

This approach allows you to maintain a high recall but also gives you a way to customize the precision of top hits.

Example:
</code></pre>
<p>GET news_headlines/_search
{
  "query": {
    "bool": {
      "must": [
        {
          "match_phrase": {
            "headline": "Michelle Obama"
          }
        }
      ],
      "should": [
        {
          "match": {
            "headline": "Becoming"
          }
        },
        {
          "match": {
            "headline": "women"
          }
        },
        {
          "match": {
            "headline": "empower"
          }
        }
      ]
    }
  }
}
```
Expected response from Elasticsearch:</p>
<p>Adding many <code>queries</code> under the <code>should clause</code> did not reduce the number of hits(207). However, it favored documents that match the <code>queries</code> in the <code>should clause</code> and improved the precision of top search results. </p>
<p><img alt="image" src="https://user-images.githubusercontent.com/60980933/108548611-51a8f980-72a9-11eb-8310-0fe14286e437.png"/></p>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<nav aria-label="Footer" class="md-footer__inner md-grid">
<a aria-label="Previous: Part 2 Understanding the relevance of your search with Elasticsearch and Kibana" class="md-footer__link md-footer__link--prev" href="../Part_2_Understanding_the_relevance_of_your_search_with_Elasticsearch_and_Kibana/" rel="prev">
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</div>
<div class="md-footer__title">
<div class="md-ellipsis">
<span class="md-footer__direction">
                Previous
              </span>
              Part 2 Understanding the relevance of your search with Elasticsearch and Kibana
            </div>
</div>
</a>
<a aria-label="Next: Beginner's Crash Course to Elastic Stack Series" class="md-footer__link md-footer__link--next" href="../Part_4_Running_Aggregations_with_Elasticsearch_and_Kibana/" rel="next">
<div class="md-footer__title">
<div class="md-ellipsis">
<span class="md-footer__direction">
                Next
              </span>
              Beginner's Crash Course to Elastic Stack Series
            </div>
</div>
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"></path></svg>
</div>
</a>
</nav>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.5bf1dace.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
<script src="../../assets/javascripts/bundle.37e9125f.min.js"></script>
<script src="../../javascripts/mathjax.js"></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</body>
</html>